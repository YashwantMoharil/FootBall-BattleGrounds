{"ast":null,"code":"import { useEffect, useState } from 'react';\nimport { isVoteAnswer } from 'stream-chat';\nimport { useChatContext } from '../../../context';\nexport function useManagePollVotesRealtime(managedVoteType, cursorPaginatorState, optionId) {\n  const {\n    client\n  } = useChatContext();\n  const [votesInRealtime, setVotesInRealtime] = useState(cursorPaginatorState?.getLatestValue().items ?? []);\n  useEffect(() => cursorPaginatorState?.subscribeWithSelector(state => [state.latestPageItems], ([latestPageItems]) => setVotesInRealtime(prev => [...prev, ...latestPageItems])), [cursorPaginatorState]);\n  useEffect(() => {\n    const handleVoteEvent = event => {\n      if (!event.poll_vote) return;\n      const isAnswer = isVoteAnswer(event.poll_vote);\n      if (managedVoteType === 'answer' && !isAnswer || managedVoteType === 'vote' && (isAnswer || event.poll_vote.option_id !== optionId)) return;\n      if (event.type === 'poll.vote_removed') {\n        setVotesInRealtime(prev => event.poll_vote ? prev.filter(vote => vote.id !== event.poll_vote.id) : prev);\n      }\n      if (event.type === 'poll.vote_changed') {\n        setVotesInRealtime(prev => event.poll_vote ? prev.filter(vote => vote.id !== event.poll_vote.id) : prev);\n      }\n      if (['poll.vote_casted', 'poll.vote_changed'].includes(event.type)) {\n        setVotesInRealtime(prev => event.poll_vote ? [event.poll_vote, ...prev] : prev);\n      }\n    };\n    const voteCastedSubscription = client.on('poll.vote_casted', handleVoteEvent);\n    const voteRemovedSubscription = client.on('poll.vote_removed', handleVoteEvent);\n    const voteChangedSubscription = client.on('poll.vote_changed', handleVoteEvent);\n    return () => {\n      voteCastedSubscription.unsubscribe();\n      voteRemovedSubscription.unsubscribe();\n      voteChangedSubscription.unsubscribe();\n    };\n  }, [client, optionId, managedVoteType]);\n  return votesInRealtime;\n}","map":{"version":3,"names":["useEffect","useState","isVoteAnswer","useChatContext","useManagePollVotesRealtime","managedVoteType","cursorPaginatorState","optionId","client","votesInRealtime","setVotesInRealtime","getLatestValue","items","subscribeWithSelector","state","latestPageItems","prev","handleVoteEvent","event","poll_vote","isAnswer","option_id","type","filter","vote","id","includes","voteCastedSubscription","on","voteRemovedSubscription","voteChangedSubscription","unsubscribe"],"sources":["/Users/yashwantmoharil/Desktop/football-battlegrounds/client/node_modules/stream-chat-react/dist/components/Poll/hooks/useManagePollVotesRealtime.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { isVoteAnswer } from 'stream-chat';\nimport { useChatContext } from '../../../context';\nexport function useManagePollVotesRealtime(managedVoteType, cursorPaginatorState, optionId) {\n    const { client } = useChatContext();\n    const [votesInRealtime, setVotesInRealtime] = useState(cursorPaginatorState?.getLatestValue().items ?? []);\n    useEffect(() => cursorPaginatorState?.subscribeWithSelector((state) => [state.latestPageItems], ([latestPageItems]) => setVotesInRealtime((prev) => [...prev, ...latestPageItems])), [cursorPaginatorState]);\n    useEffect(() => {\n        const handleVoteEvent = (event) => {\n            if (!event.poll_vote)\n                return;\n            const isAnswer = isVoteAnswer(event.poll_vote);\n            if ((managedVoteType === 'answer' && !isAnswer) ||\n                (managedVoteType === 'vote' &&\n                    (isAnswer || event.poll_vote.option_id !== optionId)))\n                return;\n            if (event.type === 'poll.vote_removed') {\n                setVotesInRealtime((prev) => event.poll_vote\n                    ? prev.filter((vote) => vote.id !== event.poll_vote.id)\n                    : prev);\n            }\n            if (event.type === 'poll.vote_changed') {\n                setVotesInRealtime((prev) => event.poll_vote\n                    ? prev.filter((vote) => vote.id !== event.poll_vote.id)\n                    : prev);\n            }\n            if (['poll.vote_casted', 'poll.vote_changed'].includes(event.type)) {\n                setVotesInRealtime((prev) => event.poll_vote ? [event.poll_vote, ...prev] : prev);\n            }\n        };\n        const voteCastedSubscription = client.on('poll.vote_casted', handleVoteEvent);\n        const voteRemovedSubscription = client.on('poll.vote_removed', handleVoteEvent);\n        const voteChangedSubscription = client.on('poll.vote_changed', handleVoteEvent);\n        return () => {\n            voteCastedSubscription.unsubscribe();\n            voteRemovedSubscription.unsubscribe();\n            voteChangedSubscription.unsubscribe();\n        };\n    }, [client, optionId, managedVoteType]);\n    return votesInRealtime;\n}\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,YAAY,QAAQ,aAAa;AAC1C,SAASC,cAAc,QAAQ,kBAAkB;AACjD,OAAO,SAASC,0BAA0BA,CAACC,eAAe,EAAEC,oBAAoB,EAAEC,QAAQ,EAAE;EACxF,MAAM;IAAEC;EAAO,CAAC,GAAGL,cAAc,CAAC,CAAC;EACnC,MAAM,CAACM,eAAe,EAAEC,kBAAkB,CAAC,GAAGT,QAAQ,CAACK,oBAAoB,EAAEK,cAAc,CAAC,CAAC,CAACC,KAAK,IAAI,EAAE,CAAC;EAC1GZ,SAAS,CAAC,MAAMM,oBAAoB,EAAEO,qBAAqB,CAAEC,KAAK,IAAK,CAACA,KAAK,CAACC,eAAe,CAAC,EAAE,CAAC,CAACA,eAAe,CAAC,KAAKL,kBAAkB,CAAEM,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE,GAAGD,eAAe,CAAC,CAAC,CAAC,EAAE,CAACT,oBAAoB,CAAC,CAAC;EAC5MN,SAAS,CAAC,MAAM;IACZ,MAAMiB,eAAe,GAAIC,KAAK,IAAK;MAC/B,IAAI,CAACA,KAAK,CAACC,SAAS,EAChB;MACJ,MAAMC,QAAQ,GAAGlB,YAAY,CAACgB,KAAK,CAACC,SAAS,CAAC;MAC9C,IAAKd,eAAe,KAAK,QAAQ,IAAI,CAACe,QAAQ,IACzCf,eAAe,KAAK,MAAM,KACtBe,QAAQ,IAAIF,KAAK,CAACC,SAAS,CAACE,SAAS,KAAKd,QAAQ,CAAE,EACzD;MACJ,IAAIW,KAAK,CAACI,IAAI,KAAK,mBAAmB,EAAE;QACpCZ,kBAAkB,CAAEM,IAAI,IAAKE,KAAK,CAACC,SAAS,GACtCH,IAAI,CAACO,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAACC,EAAE,KAAKP,KAAK,CAACC,SAAS,CAACM,EAAE,CAAC,GACrDT,IAAI,CAAC;MACf;MACA,IAAIE,KAAK,CAACI,IAAI,KAAK,mBAAmB,EAAE;QACpCZ,kBAAkB,CAAEM,IAAI,IAAKE,KAAK,CAACC,SAAS,GACtCH,IAAI,CAACO,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAACC,EAAE,KAAKP,KAAK,CAACC,SAAS,CAACM,EAAE,CAAC,GACrDT,IAAI,CAAC;MACf;MACA,IAAI,CAAC,kBAAkB,EAAE,mBAAmB,CAAC,CAACU,QAAQ,CAACR,KAAK,CAACI,IAAI,CAAC,EAAE;QAChEZ,kBAAkB,CAAEM,IAAI,IAAKE,KAAK,CAACC,SAAS,GAAG,CAACD,KAAK,CAACC,SAAS,EAAE,GAAGH,IAAI,CAAC,GAAGA,IAAI,CAAC;MACrF;IACJ,CAAC;IACD,MAAMW,sBAAsB,GAAGnB,MAAM,CAACoB,EAAE,CAAC,kBAAkB,EAAEX,eAAe,CAAC;IAC7E,MAAMY,uBAAuB,GAAGrB,MAAM,CAACoB,EAAE,CAAC,mBAAmB,EAAEX,eAAe,CAAC;IAC/E,MAAMa,uBAAuB,GAAGtB,MAAM,CAACoB,EAAE,CAAC,mBAAmB,EAAEX,eAAe,CAAC;IAC/E,OAAO,MAAM;MACTU,sBAAsB,CAACI,WAAW,CAAC,CAAC;MACpCF,uBAAuB,CAACE,WAAW,CAAC,CAAC;MACrCD,uBAAuB,CAACC,WAAW,CAAC,CAAC;IACzC,CAAC;EACL,CAAC,EAAE,CAACvB,MAAM,EAAED,QAAQ,EAAEF,eAAe,CAAC,CAAC;EACvC,OAAOI,eAAe;AAC1B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}